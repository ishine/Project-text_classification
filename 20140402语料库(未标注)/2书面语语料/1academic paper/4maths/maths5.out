若 自 回归 的 阶数 为 p , 则 m: 二 n: 二 p , 这样 一方面 保证 了 历史 数据 和 残差 的 成 对 出现 , 同时 也 因为 , 原始 数据 本身 或 经 差 分 之 后 的 自 回归 阶数 , 可以 一定 程度 上 表现 了 当前 数据 与 历史 数据 之间 的 输入 输出 的 周期 关系 , 可以 使 神经 网络 的 结构 的 确定 更加 有 规律可循 , 同时 预测 结果 也 更 精确 .
4 实证 分析 为了 对 以上 多种 模型 包括 AIUMA 模型 !
EWMA 模型 !
ANN 模型 !
MEA 模型 !
IEA 模型 的 预测 精度 进行 横向 比较 , 选取 了 2012年 1月 4日 至 2012年 4月 26日 的 上证 收盘 指数 共 70 个 数据 进行 实证 分析 .
上证 指数 的 发展趋势 图 见 图2 ( 画图 软件 为 Matlab7 .
0 , 以 下 图 同 ) .
4. 1 自 回归 求和 滑动平均 模型 ( ARIMAmodel ) 预测 运用 Evlews6 .
0 软件 , 以 自 相关 系数 函数 p !
和 偏 自 协 方差 函数 人 !
的 特性 为 模型 识别 工具 , 以 AIC 准则 和 SW 准则 为 模型 的 取舍 标准 , 得 比较 结果 如 表 1 所 示 .
表 l 不 同 ARIMA 模型 的 AIC 与 SW 取值 可见 , ARIMA ( 3 , 2 , l ) 模型 的 AIC 及 Sw 最 小 , 故 考虑 用 AIUMA ( 3 , 2 , l ) 模型 进行 预测 , 并 得 预测 模型 为 : ( 1+0. 19589B+o. 15olsBZ+o. 12209B3 ) 及 二 a: +o. 95983a 卜 , 由 模型 易 得 预测 值 与 真实 值 的 拟合 情况 见 图3 , 还 可 计算 应用 A 班 MA 模型 的 预测 的 均方误差 4. 2 指数 加权 滑动平均 模型 ( EWMAmodel ) 预测 由 上证 指数 的 发展趋势 图 可以 看出 其 带有 趋势 性 , 因此 一 阶 指数 平滑 模型 不 适合 [ v ] , 也 并非 二 次 指数 平滑 , 因为 其 发展趋势 不 是 线性 的 , 这里 考虑 选用 三 次 指数 平滑 法 , 对 不同 的 衰减 因子 a , 得到 的 不同 的 预测 的 均方误差 如 表 2 所 示 .
一 种 改进 的 基于 指数 平滑 神经 网络 模型 的 时间 序列 预测 方法 表 2 不同 衰减 因子 模型 预测 的 最 小 均方误差 上证 指数 趋势 图图 3ARIMA 模型 的 预测 图 选择 使 均方误差 最 小 的 衰减 因子 a = 0. 3 , 此时 三 阶 EWMA 模型 的 预测 值 与 真实 值 的 拟合 图 见 图 4 , 并 可 求得 三 次 指数 平滑 模型 的 预测 均方误差 14. 921 明显 小于 ARIMA ( 3 , 2 , l ) 模型 的 均方误差 , 也 即 更 有 更 高 的 预测 精度 , 所以 在 下面 的 修正 的 混 合 模型 及 改进 的 混 合 模型 中 均 考虑 用 三 次 指数 平滑 模型 与 神经 网络 模型 的 混 合 模型 , 而 ARIMA 模型 的 自 回归 阶数 ( 3阶 ) 将 被 用于 BP 神经 网络 !
MEA 模型 和 IEA 模型 的 神经 网络 结构 .
4. 3 神经 网络 模型 ( ANNmodel ) 预测 [ 3 一 0 , .
o , -6 ] 由于 AIUMA 模型 的 自 回归 阶数 为 3 , 所以 考虑 用 人工 神经 网络 的 输入 层 为 3 个 神经元 灸 一 1 , 介 一 2 , 几 一 3 , 输出 层 为 1 个 神经元 夙 , 隐 层 根据 经验 公式 沂 丽 不 十 " , 其中 " !
n 分别 是 输入 层 和 输出 层 的 神经元 个数 , a 是 O 到 10 之间 的 常 整数 .
经过 多次 试验 , 令 隐 层 神经元 数 为 10 个 .
并 将 数据 输入 SPSS16 .
0 神经 网络 工具箱 , 参数设定 如下 : l ) 传递 函数 为 sigmo , d 函数 , 即 f ( x ) = 六 春 二 ; 2 ) 学习 参数 " 一 o # 4 ; 3 ) 用 梯度 下降 法 , 动量 因子 a = 0. 9 ; 4 ) 训练 精度 为 0. 001 此 BP 神经 网络 的 拓扑 结构 为 3 一 10 一 1 , 见 图 5 , 预测 值 与 真实 值 的 拟合 曲线 见 图 5 , 其 预测 均方误差 为 27. 512 , 要 大干 指数 平滑 模型 的 均方误差 值 , 从 拟合 图像 也 可 粗略 看出 .
4. 4 指数 加权 滑动 一 平均 神经 网络 混 合 模型 ( MEAmodel ) 预测 这里 再 用 三 阶 指数 加权 滑动平均 神经 网络 模型 对 上证 指数 时间 序列 进行 预测 !
5 , 12 ] .
设 三 次 指数 平滑 后 的 模型 的 t 时刻 的 残差 为 :: , 对 残差 进行 神经 网络 输入 , 与 单独 神经 网络 模型 类似 设定 神经 网络 拓扑 结构 为 3 一 10 一 1 , 输入 神经元 为 几 一: , 几 一 2 , : 卜 3 , 输出 神经元 为 : - , 设定 参数 也 与 上述 ANN 模型 一直 , 修正 后 的 残差 为 成 , 修正 后 的 预测 值 为 从 = L: + 成 , 而 真实 值 为 z " 二 L 亡 + " " , 所以 修正 后 的 预测 残差 为 叮 二: " 一 成 , 预测 拟合 曲线 如 见 图 6 , 且 经计算 得 MEA 模型 的 预测 均方误差 为 10. 6354 , 显 著 小于 前面 的 几 类 模型 , 拟合 曲线 也 现实 预测 值 与 真实 值 已 非常 接近 , 可见 混 合 模型 对于 单个 的 独立 模型 来说 具有 明显 的 优越性 .
4. 5 改进 的 指数 加权 滑动平均 一 神经 网络 模型 ( IEAmodel ) 预测 建模 步骤 为 : 第1 步 根据 三 次 指数 平滑 模型 得出 预测 值 及其 残差 ; 第2 步 根据 时间 序列 在 ARIMA 模型 中 的 自 回归 阶数 确定 混 合 模型 中 神经 网络 模型 的 输入 层信息 , 包含 的 信息 有 历史 数据 及 其 残差 , 三 次 指数 平滑 模型 的 预测 值 , 具体 为 自 一 1 , :: 一 2 , :: 一 3 , L: , Zt 一 1 , 乙 一 2 , 夙 一 3 , 隐 层 神经元 个数 为 15 , 转换 函数 及 学习 率 和 动量 参数均 和 之前 一致 , 输出 层 为 及 .
第 3 步 将 数据 整理 好 输入 SPSS 神经 网络 工具箱 , 令 70% 的 数据 作为 训练 集 , 30% 的 数据 作为 测试集 , 得出 的 预测 效果 图 见 图 7 , 其 预测 均方误差 值 为 7. 728 , 远 小于 以上 4 个 模型 ( AluMA , EwMA , ANN , MEA ) 的 预测 均方误差 , 由 预测 拟合 情况 也 可 看出 预测 值 和 真实 值 几乎 完全 重合 , 预测 误差 控制 在 0. 5% 以内 , 可以 用于 关于 上证 指数 的 投资 预测 .
